<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <title>Tableau de Bord Admin</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script src="/mock/wixApi.js"></script> 
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.8/babel.min.js"></script>
    
    <style>
        :root {
            --primary-gradient: linear-gradient(-45deg, #2C44C2, #2196F3, #3F51B5, #1976D2);
            --card-gradient: linear-gradient(135deg, rgba(255,255,255,0.9), rgba(255,255,255,0.7));
            --shadow-sm: 0 2px 8px rgba(0,0,0,0.1);
            --shadow-md: 0 4px 12px rgba(0,0,0,0.15);
            --shadow-lg: 0 8px 24px rgba(0,0,0,0.2);
            --border-radius: 12px;
            --transition: all 0.3s ease;
        }

        @keyframes gradientBG {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }

        body {
            font-family: 'Inter', sans-serif;
            margin: 0;
            padding: 20px;
            background: #f3f2eb;
            min-height: 100vh;
        }

        .dashboard {
            background: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(10px);
            border-radius: var(--border-radius);
            padding: 25px;
            box-shadow: var(--shadow-lg);
            max-width: 1200px;
            margin: 0 auto;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .title {
            font-size: 32px;
            background: var(--primary-gradient);
            background-size: 400% 400%;
            animation: gradientBG 15s ease infinite;
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
            margin-bottom: 30px;
            font-weight: 700;
            text-align: center;
            letter-spacing: -0.5px;
        }

        .actions, .filters {
            margin-bottom: 25px;
            display: flex;
            flex-wrap: wrap;
            gap: 15px;
            align-items: center;
            justify-content: space-between;
            background: var(--card-gradient);
            padding: 15px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-sm);
        }

        select, input {
            padding: 10px 15px;
            border: 1px solid rgba(0,0,0,0.1);
            border-radius: var(--border-radius);
            background: rgba(255,255,255,0.9);
            font-size: 14px;
            transition: var(--transition);
            box-shadow: var(--shadow-sm);
        }

        select:hover, input:hover {
            border-color: #2196F3;
        }

        select:focus, input:focus {
            outline: none;
            border-color: #2C44C2;
            box-shadow: 0 0 0 3px rgba(44,68,194,0.2);
        }

        .btn {
            padding: 10px 20px;
            cursor: pointer;
            border: none;
            border-radius: var(--border-radius);
            font-weight: 600;
            transition: var(--transition);
            display: inline-flex;
            align-items: center;
            gap: 8px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-size: 13px;
        }

        .btn-primary {
            background: var(--primary-gradient);
            background-size: 200% 200%;
            color: white;
            animation: gradientBG 15s ease infinite;
            box-shadow: var(--shadow-md);
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .contract-card {
            background: var(--card-gradient);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-md);
            margin-bottom: 20px;
            overflow: hidden;
            border: 1px solid rgba(255,255,255,0.3);
            backdrop-filter: blur(10px);
            transition: var(--transition);
        }

        .contract-card:hover {
            transform: translateY(-5px);
            box-shadow: var(--shadow-lg);
        }

        .contract-header {
            background: var(--primary-gradient);
            background-size: 200% 200%;
            animation: gradientBG 15s ease infinite;
            padding: 20px;
            color: white;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .contract-status {
            padding: 8px 16px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 0.9em;
            display: flex;
            align-items: center;
            gap: 8px;
            backdrop-filter: blur(5px);
            box-shadow: var(--shadow-sm);
        }

        .contract-status.active {
            background: rgba(46, 125, 50, 0.2);
            color: #2e7d32;
        }

        .contract-status.expired {
            background: rgba(211, 47, 47, 0.2);
            color: #d32f2f;
        }

        .contract-status.ending-soon {
            background: rgba(245, 124, 0, 0.2);
            color: #f57c00;
        }

        .contract-body {
            padding: 20px;
        }

        .info-group {
            background: rgba(255,255,255,0.7);
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-sm);
            transition: var(--transition);
        }

        .info-group:hover {
            background: rgba(255,255,255,0.9);
            transform: translateY(-2px);
        }

        .info-group h4 {
            color: #2C44C2;
            font-size: 1.1em;
            margin-bottom: 15px;
            border-bottom: 2px solid #2C44C2;
            padding-bottom: 8px;
        }

        .toast-container {
            position: fixed;
            top: 20px;
            right: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
            z-index: 2000;
        }

        .toast {
            min-width: 300px;
            padding: 15px 20px;
            border-radius: var(--border-radius);
            color: white;
            font-size: 14px;
            box-shadow: var(--shadow-lg);
            display: flex;
            align-items: center;
            gap: 10px;
            animation: slideIn 0.5s ease forwards;
            background: var(--primary-gradient);
            background-size: 200% 200%;
            animation: gradientBG 15s ease infinite, slideIn 0.5s ease forwards;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            backdrop-filter: blur(5px);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            animation: fadeIn 0.3s ease;
        }

        .modal-content {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--shadow-lg);
            width: 90%;
            max-width: 500px;
            animation: modalSlideUp 0.5s ease;
        }

        @keyframes modalSlideUp {
            from { transform: translateY(50px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }

        @media (max-width: 768px) {
            .dashboard {
                padding: 15px;
            }

            .title {
                font-size: 24px;
            }

            .actions, .filters {
                flex-direction: column;
                align-items: stretch;
            }

            .btn {
                width: 100%;
                justify-content: center;
            }
        }
    </style>
</head>
</html>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // Existing utility functions remain unchanged
        const formatDate = (dateString) => {
            if (!dateString) return "N/A";
            const date = new Date(dateString);
            return date.toLocaleDateString('fr-FR', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric'
            });
        };

        const filterData = (data, searchTerm) => {
            if (!searchTerm) return data;
            const lowerTerm = searchTerm.toLowerCase();
            return data.filter(item => {
                return Object.values(item).some(val => val && val.toString().toLowerCase().includes(lowerTerm));
            });
        };

        // Enhanced Employee Section with animations and icons
        const EmployeSection = ({ employes, handleDelete, handleEdit }) => (
            <div className="employe-section">
                {employes.map(emp => (
                    <div key={emp._id} className="contract-card">
                        <div className="contract-header">
                            <span className="contract-id">
                                <i className="fas fa-user-circle fa-lg"></i>
                                {emp.Pr√©nom} {emp.Nom}
                            </span>
                            <div className="contract-status active" title="Employ√© actif">
                                <i className="fas fa-check-circle"></i>
                                Actif
                            </div>
                        </div>
                        <div className="contract-body">
                            <div className="contract-info">
                                <div className="info-group">
                                    <h4><i className="fas fa-info-circle"></i> D√©tails de l'employ√©</h4>
                                    <p><i className="fas fa-phone"></i> T√©l√©phone: {emp.T√©l√©phone}</p>
                                    <p><i className="fas fa-envelope"></i> Email: {emp.Courriel}</p>
                                    <p><i className="fas fa-dollar-sign"></i> Salaire Horaire: {emp["Salaire horaire"]} $</p>
                                </div>
                            </div>
                        </div>
                    </div>
                ))}
            </div>
        );

        // Enhanced Contract Section with better visualization
        const ContratSection = ({ contracts, handleDelete, handleEdit }) => {
            const getContractStatus = (startDate, endDate) => {
                const now = new Date();
                const start = new Date(startDate);
                const end = new Date(endDate);
                const daysUntilEnd = Math.ceil((end - now) / (1000 * 60 * 60 * 24));
                const contractLength = Math.ceil((end - start) / (1000 * 60 * 60 * 24));

                if (now > end) {
                    return {
                        status: 'expired',
                        icon: 'fas fa-exclamation-circle',
                        label: 'Expir√©',
                        tooltip: `Contrat termin√© depuis ${Math.abs(daysUntilEnd)} jours`
                    };
                } else if (daysUntilEnd <= 30) {
                    return {
                        status: 'ending-soon',
                        icon: 'fas fa-clock',
                        label: 'Se termine bient√¥t',
                        tooltip: `${daysUntilEnd} jours restants sur ${contractLength} jours`
                    };
                } else {
                    return {
                        status: 'active',
                        icon: 'fas fa-check-circle',
                        label: 'Actif',
                        tooltip: `${daysUntilEnd} jours restants sur ${contractLength} jours`
                    };
                }
            };

            const calculateContractValue = (hours, rate, weeks) => {
                return (hours * rate * weeks).toFixed(2);
            };

            return (
                <div>
                    {contracts.map(contract => {
                        const status = getContractStatus(contract.dateDeDebut, contract.dateDeFin);
                        const startDate = new Date(contract.dateDeDebut);
                        const endDate = new Date(contract.dateDeFin);
                        const weeks = Math.ceil((endDate - startDate) / (1000 * 60 * 60 * 24 * 7));
                        const employee = contract.employeeDetails || {};
                        const contractValue = calculateContractValue(
                            contract.NombreHeuresParSemaine,
                            employee["Salaire horaire"] || 0,
                            weeks
                        );

                        return (
                            <div key={contract._id} className="contract-card">
                                <div className="contract-header">
                                    <span className="contract-id">
                                        <i className="fas fa-file-contract"></i>
                                        {contract.contratId}
                                    </span>
                                    <div 
                                        className={`contract-status ${status.status}`}
                                        title={status.tooltip}
                                    >
                                        <i className={status.icon}></i>
                                        {status.label}
                                    </div>
                                </div>
                                <div className="contract-body">
                                    <div className="contract-info">
                                        <div className="info-group">
                                            <h4><i className="fas fa-info-circle"></i> D√©tails du contrat</h4>
                                            <p><i className="fas fa-calendar-alt"></i> D√©but: {formatDate(contract.dateDeDebut)}</p>
                                            <p><i className="fas fa-calendar-alt"></i> Fin: {formatDate(contract.dateDeFin)}</p>
                                            <p><i className="fas fa-clock"></i> Dur√©e: {weeks} semaines</p>
                                            <p><i className="fas fa-business-time"></i> Heures/semaine: {contract.NombreHeuresParSemaine}h</p>
                                        </div>
                                        <div className="info-group">
                                            <h4><i className="fas fa-user"></i> Employ√©</h4>
                                            <p><i className="fas fa-user-circle"></i> {employee.Pr√©nom} {employee.Nom}</p>
                                            <p><i className="fas fa-phone"></i> T√©l: {employee.T√©l√©phone}</p>
                                            <p><i className="fas fa-envelope"></i> Email: {employee.Courriel}</p>
                                            <p><i className="fas fa-dollar-sign"></i> Taux horaire: {employee["Salaire horaire"] || 'N/A'}$/h</p>
                                        </div>
                                        <div className="info-group">
                                            <h4><i className="fas fa-chart-line"></i> Valeur du contrat</h4>
                                            <p><i className="fas fa-clock"></i> Total des heures: {contract.NombreHeuresParSemaine * weeks}h</p>
                                            <p><i className="fas fa-dollar-sign"></i> Valeur estim√©e: {contractValue}$</p>
                                        </div>
                                    </div>
                                    <div className="contract-actions">
                                        <button 
                                            className="btn btn-secondary"
                                            onClick={() => handleEdit(contract)}
                                        >
                                            <i className="fas fa-edit"></i>
                                            Modifier
                                        </button>
                                        <button 
                                            className="btn btn-danger"
                                            onClick={() => handleDelete(contract._id)}
                                        >
                                            <i className="fas fa-trash-alt"></i>
                                            Supprimer
                                        </button>
                                    </div>
                                </div>
                            </div>
                        );
                    })}
                </div>
            );
        };

        // Enhanced Document Section with better status visualization
        const DocumentSection = ({ documents, handleDelete, handleEtatChange, handleEdit }) => {
            const getDocumentStatus = (etat) => {
                switch(etat?.toLowerCase()) {
                    case 'valider':
                        return {
                            status: 'active',
                            icon: 'fas fa-check-circle',
                            label: 'Valid√©',
                            tooltip: 'Document valid√©'
                        };
                    case 'archiver':
                        return {
                            status: 'expired',
                            icon: 'fas fa-archive',
                            label: 'Archiv√©',
                            tooltip: 'Document archiv√©'
                        };
                    default:
                        return {
                            status: 'ending-soon',
                            icon: 'fas fa-clock',
                            label: 'En attente',
                            tooltip: 'En attente de validation'
                        };
                }
            };

            return (
                <div className="document-section">
                    {documents.map(doc => {
                        const status = getDocumentStatus(doc.tat);
                        return (
                            <div key={doc._id} className="contract-card">
                                <div className="contract-header">
                                    <span className="contract-id">
                                        <i className="fas fa-file-alt"></i>
                                        {doc.nom}
                                    </span>
                                    <div 
                                        className={`contract-status ${status.status}`}
                                        title={status.tooltip}
                                    >
                                        <i className={status.icon}></i>
                                        {status.label}
                                    </div>
                                </div>
                                <div className="contract-body">
                                    <div className="contract-info">
                                        <div className="info-group">
                                            <h4><i className="fas fa-info-circle"></i> Informations</h4>
                                            <p><i className="fas fa-file-alt"></i> Type: {doc.typeDeDocument}</p>
                                            <p><i className="fas fa-calendar-alt"></i> Date: {formatDate(doc.dateDeTelechargement)}</p>
                                            <p>
                                                <i className="fas fa-tasks"></i> √âtat: 
                                                <select 
                                                    value={doc.tat} 
                                                    onChange={(e) => handleEtatChange(doc._id, e.target.value)}
                                                    className="status-select"
                                                >
                                                    <option value="en attente">En attente</option>
                                                    <option value="valider">Valid√©</option>
                                                    <option value="archiver">Archiv√©</option>
                                                </select>
                                            </p>
                                        </div>
                                    </div>
                                    <div className="contract-actions">
                                        {doc.fichier && doc.fichier !== 'null' && (
                                            <button 
                                                className="btn btn-primary"
                                                onClick={() => window.parent.postMessage({ type: 'requestDownload', fileId: doc._id }, '*')}
                                            >
                                                <i className="fas fa-download"></i>
                                                T√©l√©charger
                                            </button>
                                        )}
                                        <button 
                                            className="btn btn-secondary"
                                            onClick={() => handleEdit(doc)}
                                        >
                                            <i className="fas fa-edit"></i>
                                            Modifier
                                        </button>
                                        <button 
                                            className="btn btn-danger"
                                            onClick={() => handleDelete(doc._id)}
                                        >
                                            <i className="fas fa-trash-alt"></i>
                                            Supprimer
                                        </button>
                                    </div>
                                </div>
                            </div>
                        );
                    })}
                </div>
            );
        };

        // Enhanced Payment Section with better visualization
        const PaiementSection = ({ paiements, handleDelete, handleEdit }) => {
            const getPaymentStatus = (statut) => {
                if (statut === true) {
                    return {
                        status: 'active',
                        icon: 'fas fa-check-circle',
                        label: 'Envoy√©',
                        tooltip: 'Paiement envoy√©'
                    };
                } else {
                    return {
                        status: 'ending-soon',
                        icon: 'fas fa-clock',
                        label: 'En attente',
                        tooltip: 'En attente d\'envoi'
                    };
                }
            };

            return (
                <div className="paiement-section">
                    {paiements.map(p => {
                        const status = getPaymentStatus(p.statut);
                        return (
                            <div key={p._id} className="contract-card">
                                <div className="contract-header">
                                    <span className="contract-id">
                                        <i className="fas fa-money-check-alt"></i>
                                        Paiement {p.paiementId}
                                    </span>
                                    <div 
                                        className={`contract-status ${status.status}`}
                                        title={status.tooltip}
                                    >
                                        <i className={status.icon}></i>
                                        {status.label}
                                    </div>
                                </div>
                                <div className="contract-body">
                                    <div className="contract-info">
                                        <div className="info-group">
                                            <h4><i className="fas fa-info-circle"></i> D√©tails du paiement</h4>
                                            <p><i className="fas fa-dollar-sign"></i> Montant: {p.montant !== undefined ? `${p.montant} $` : 'N/A'}</p>
                                            <p><i className="fas fa-clock"></i> Heures travaill√©es: {p.nombredheure}h</p>
                                            <p><i className="fas fa-calendar-alt"></i> Date pr√©vue: {formatDate(p.dateDePaiement)}</p>
                                            <p><i className="fas fa-credit-card"></i> M√©thode: {p.mthodeDePaiement || 'N/A'}</p>
                                        </div>
                                        <div className="info-group">
                                            <h4><i className="fas fa-user"></i> Employ√©</h4>
                                            <p><i className="fas fa-user-circle"></i> {p.employeeDetails?.Pr√©nom} {p.employeeDetails?.Nom}</p>
                                            <p><i className="fas fa-phone"></i> T√©l: {p.employeeDetails?.T√©l√©phone}</p>
                                            <p><i className="fas fa-envelope"></i> Email: {p.employeeDetails?.Courriel}</p>
                                        </div>
                                        <div className="info-group">
                                            <h4><i className="fas fa-file-invoice"></i> Preuve de paiement</h4>
                                            {p.preuveDePaiement ? (
                                                <>
                                                    <p><i className="fas fa-check-circle"></i> √âtat: {p.preuveDePaiement.etat || 'Non sp√©cifi√©'}</p>
                                                    <p><i className="fas fa-file-alt"></i> Nom: {p.preuveDePaiement.nom || 'Sans titre'}</p>
                                                    <p><i className="fas fa-id-card"></i> Document ID: {p.preuveDePaiement.documentId || 'N/A'}</p>
                                                    <p><i className="fas fa-calendar-alt"></i> Date de t√©l√©chargement: {formatDate(p.preuveDePaiement.dateDeTelechargement)}</p>
                                                    <p><i className="fas fa-file-invoice"></i> Type: {p.preuveDePaiement.typeDeDocument || 'Non sp√©cifi√©'}</p>
                                                </>
                                            ) : (
                                                <p><i className="fas fa-exclamation-circle"></i> Aucune preuve fournie</p>
                                            )}
                                        </div>
                                    </div>
                                    <div className="contract-actions">
                                        {p.preuveDePaiement?.fichier && (
                                            <button 
                                                className="btn btn-primary"
                                                onClick={() => window.parent.postMessage({ type: 'requestDownload', fileId: p.preuveDePaiement._id }, '*')}
                                            >
                                                <i className="fas fa-download"></i>
                                                T√©l√©charger la preuve
                                            </button>
                                        )}
                                        <button 
                                            className="btn btn-secondary"
                                            onClick={() => handleEdit(p)}
                                        >
                                            <i className="fas fa-edit"></i>
                                            Modifier
                                        </button>
                                        <button 
                                            className="btn btn-danger"
                                            onClick={() => handleDelete(p._id)}
                                        >
                                            <i className="fas fa-trash-alt"></i>
                                            Supprimer
                                        </button>
                                    </div>
                                </div>
                            </div>
                        );
                    })}
                </div>
            );
        };

        // Enhanced Dashboard Component
        const Dashboard = () => {
            const [view, setView] = useState("Employes");
            const [data, setData] = useState([]);
            const [loading, setLoading] = useState(true);
            const [messageQueue, setMessageQueue] = useState([]);
            const [showDeleteConfirmation, setShowDeleteConfirmation] = useState(false);
            const [itemToDelete, setItemToDelete] = useState(null);
            const [showEditModal, setShowEditModal] = useState(false);
            const [itemToEdit, setItemToEdit] = useState(null);
            const [searchTerm, setSearchTerm] = useState('');

            useEffect(() => {
                const handleMessage = (event) => {
                    const { data: messageData } = event;
                    if (!messageData) return;

                    switch(messageData.type) {
                        case 'dataLoaded':
                            setData(messageData.data);
                            setLoading(false);
                            break;
                        case 'downloadFile':
                            try {
                                if (!messageData.url) {
                                    throw new Error("URL de t√©l√©chargement manquante");
                                }
                                const iframe = document.createElement('iframe');
                                iframe.style.display = 'none';
                                document.body.appendChild(iframe);
                                iframe.src = messageData.url;
                                setTimeout(() => {
                                    document.body.removeChild(iframe);
                                }, 2000);
                                addToast("T√©l√©chargement d√©marr√©", "success");
                            } catch (error) {
                                addToast("Erreur lors du t√©l√©chargement: " + error.message, "error");
                            }
                            break;
                        case 'operationSuccess':
                            addToast(messageData.message, "success");
                            window.parent.postMessage({ type: 'loadData', filters: { view } }, '*');
                            break;
                        case 'operationError':
                            addToast(messageData.message, "error");
                            setLoading(false);
                            break;
                    }
                };

                window.addEventListener('message', handleMessage);
                return () => window.removeEventListener('message', handleMessage);
            }, [view]);

            useEffect(() => {
                setLoading(true);
                window.parent.postMessage({ 
                    type: 'loadData', 
                    filters: { view }
                }, '*');
            }, [view]);

            const handleDelete = (id) => {
                setItemToDelete(id);
                setShowDeleteConfirmation(true);
            };

            const confirmDelete = () => {
                if (itemToDelete) {
                    window.parent.postMessage({ type: 'deleteItem', view, id: itemToDelete }, '*');
                }
                setShowDeleteConfirmation(false);
                setItemToDelete(null);
            };

            const cancelDelete = () => {
                setShowDeleteConfirmation(false);
                setItemToDelete(null);
            };

            const handleEtatChange = (id, newEtat) => {
                window.parent.postMessage({ type: 'updateDocumentEtat', id, newEtat }, '*');
            };

            const handleAdd = () => {
                const urls = {
                    Contrats: '/creation-de-contrat',
                    Documents: '/creation-de-document',
                    Paiements: '/creation-de-paiement'
                };
                if (urls[view]) {
                    window.parent.postMessage({ type: 'navigate', url: urls[view] }, '*');
                }
            };

            const handleEdit = (item) => {
                setItemToEdit(item);
                setShowEditModal(true);
            };

            const confirmEdit = (updatedItem) => {
                window.parent.postMessage({ type: 'updateItem', view, data: updatedItem }, '*');
                setShowEditModal(false);
                setItemToEdit(null);
                setLoading(true);
            };

            const cancelEdit = () => {
                setShowEditModal(false);
                setItemToEdit(null);
            };

            const addToast = (text, type) => {
                const id = Math.random().toString(36).substr(2, 9);
                setMessageQueue(prev => [...prev, { id, text, type }]);
                setTimeout(() => {
                    setMessageQueue(prev => prev.filter(m => m.id !== id));
                }, 3000);
            };

            const filteredData = filterData(data, searchTerm);

            return (
                <div className="dashboard">
                    <div className="toast-container">
                        {messageQueue.map(msg => (
                            <div key={msg.id} className={`toast ${msg.type}`}>
                                <i className={msg.type === 'success' ? 'fas fa-check-circle' : 'fas fa-exclamation-circle'}></i>
                                {msg.text}
                            </div>
                        ))}
                    </div>

                    <div className="title">
                        <i className="fas fa-tachometer-alt"></i>
                        Tableau de Bord Admin
                    </div>

                    <div className="actions">
                        <select 
                            value={view} 
                            onChange={(e) => setView(e.target.value)}
                            className="view-select"
                        >
                            <option value="Employes">üë• Employ√©s</option>
                            <option value="Contrats">üìÑ Contrats</option>
                            <option value="Documents">üìÅ Documents</option>
                            <option value="Paiements">üí≥ Paiements</option>
                        </select>

                        {view !== 'Employes' && (
                            <button className="btn btn-primary" onClick={handleAdd}>
                                <i className="fas fa-plus"></i>
                                Ajouter {view}
                            </button>
                        )}
                    </div>

                    <div className="filters">
                        <div className="filter-group">
                            <label>
                                <i className="fas fa-search"></i>
                                Rechercher :
                                <input 
                                    type="text" 
                                    value={searchTerm} 
                                    onChange={(e) => setSearchTerm(e.target.value)} 
                                    placeholder="Tapez pour filtrer..." 
                                />
                            </label>
                        </div>
                    </div>

                    {loading ? (
                        <div className="loading">
                            <div className="loadingio-spinner-spinner">
                                <div className="ldio-calm-earwig">
                                    <div></div><div></div><div></div><div></div>
                                    <div></div><div></div><div></div><div></div>
                                </div>
                            </div>
                        </div>
                    ) : (
                        <>
                            {view === 'Employes' && (
                                <EmployeSection 
                                    employes={filteredData} 
                                    handleDelete={handleDelete} 
                                    handleEdit={handleEdit}
                                />
                            )}
                            {view === 'Contrats' && (
                                <ContratSection 
                                    contracts={filteredData} 
                                    handleDelete={handleDelete}
                                    handleEdit={handleEdit}
                                />
                            )}
                            {view === 'Documents' && (
                                <DocumentSection 
                                    documents={filteredData}
                                    handleDelete={handleDelete}
                                    handleEtatChange={handleEtatChange}
                                    handleEdit={handleEdit}
                                />
                            )}
                            {view === 'Paiements' && (
                                <PaiementSection
                                    paiements={filteredData}
                                    handleDelete={handleDelete}
                                    handleEdit={handleEdit}
                                />
                            )}
                        </>
                    )}

                    <Modal
                        isOpen={showDeleteConfirmation}
                        onClose={cancelDelete}
                    >
                        <div className="wrapper">
                            <div className="top">
                                <h1>Confirmation</h1>
                                <p>√ätes-vous s√ªr de vouloir supprimer cet √©l√©ment ?</p>
                            </div>
                            <div className="bottom">
                                <button className="cancel" onClick={cancelDelete}>
                                    <i className="fas fa-times"></i>
                                    Annuler
                                </button>
                                <button className="confirm" onClick={confirmDelete}>
                                    <i className="fas fa-check"></i>
                                    Confirmer
                                </button>
                            </div>
                        </div>
                    </Modal>

                    {showEditModal && (
                        <EditModal
                            isOpen={showEditModal}
                            onClose={cancelEdit}
                            item={itemToEdit}
                            view={view}
                            onConfirm={confirmEdit}
                        />
                    )}
                </div>
            );
        };

        // Modal Components
        const Modal = ({ isOpen, onClose, children }) => {
            if (!isOpen) return null;
            return (
                <div className="modal-backdrop" onClick={(e) => e.target === e.currentTarget && onClose()}>
                    <div className="modal-content">
                        {children}
                    </div>
                </div>
            );
        };

        const EditModal = ({ isOpen, onClose, item, view, onConfirm }) => {
            const [formData, setFormData] = useState({ ...item });

            const handleChange = (e) => {
                const { name, value } = e.target;
                setFormData(prev => ({ ...prev, [name]: value }));
            };

            const handleSubmit = (e) => {
                e.preventDefault();
                onConfirm(formData);
            };

            return (
                <Modal isOpen={isOpen} onClose={onClose}>
                    <div className="wrapper">
                        <div className="top">
                            <h1>Modifier {view.slice(0, -1)}</h1>
                        </div>
                        <form onSubmit={handleSubmit}>
                            {view === 'Contrats' && (
                                <>
                                    <label>
                                        <i className="fas fa-calendar-alt"></i>
                                        Date de D√©but:
                                        <input
                                            type="date"
                                            name="dateDeDebut"
                                            value={formData.dateDeDebut || ''}
                                            onChange={handleChange}
                                        />
                                    </label>
                                    <label>
                                        <i className="fas fa-calendar-alt"></i>
                                        Date de Fin:
                                        <input
                                            type="date"
                                            name="dateDeFin"
                                            value={formData.dateDeFin || ''}
                                            onChange={handleChange}
                                        />
                                    </label>
                                    <label>
                                        <i className="fas fa-clock"></i>
                                        Heures/Semaine:
                                        <input
                                            type="number"
                                            name="NombreHeuresParSemaine"
                                            value={formData.NombreHeuresParSemaine || ''}
                                            onChange={handleChange}
                                        />
                                    </label>
                                </>
                            )}
                            {view === 'Documents' && (
                                <>
                                    <label>
                                        <i className="fas fa-file-alt"></i>
                                        Nom:
                                        <input
                                            type="text"
                                            name="nom"
                                            value={formData.nom || ''}
                                            onChange={handleChange}
                                        />
                                    </label>
                                    <label>
                                        <i className="fas fa-tags"></i>
                                        Type:
                                        <select
                                            name="typeDeDocument"
                                            value={formData.typeDeDocument || ''}
                                            onChange={handleChange}
                                        >
                                            <option value="">S√©lectionnez un type</option>
                                            <option value="Contrat">Contrat</option>
                                            <option value="Plan de projet">Plan de projet</option>
                                            <option value="Facture">Facture</option>
                                            <option value="Preuve de paiement">Preuve de paiement</option>
                                            <option value="Specimen de ch√®que">Specimen de ch√®que</option>
                                            <option value="Feuilles de temps">Feuilles de temps</option>
                                        </select>
                                    </label>
                                    <label>
                                        √âtat:
                                        <select
                                            name="tat"
                                            value={formData.tat || ''}
                                            onChange={handleChange}
                                        >
                                            <option value="">S√©lectionnez un √©tat</option>
                                            <option value="en attente">En attente</option>
                                            <option value="valider">Valid√©</option>
                                            <option value="archiver">Archiv√©</option>
                                        </select>
                                    </label>
                                    {/* ...autres champs si n√©cessaire... */}
                                </>
                            )}
                            {view === 'Paiements' && (
                                <>
                                    <label>
                                        Montant:
                                        <input
                                            type="number"
                                            name="montant"
                                            value={formData.montant || ''}
                                            onChange={handleChange}
                                        />
                                    </label>
                                    <label>
                                        Date de Paiement:
                                        <input
                                            type="date"
                                            name="dateDePaiement"
                                            value={formData.dateDePaiement || ''}
                                            onChange={handleChange}
                                        />
                                    </label>
                                    {/* ...autres champs si n√©cessaire... */}
                                </>
                            )}

                            <div className="bottom">
                                <button type="button" className="cancel" onClick={onClose}>
                                    Annuler
                                </button>
                                <button type="submit" className="confirm">
                                    Enregistrer
                                </button>
                            </div>
                        </form>
                    </div>
                </Modal>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<Dashboard />);
    </script>
</body>
</html>

